-- EXAM7_5
SELECT * FROM EXAM7_5_1;
SELECT * FROM EXAM7_5_2;

SELECT * FROM EXAM7_5_1 X LEFT OUTER JOIN EXAM7_5_2 Y
ON X.C=Y.C; -- 3

SELECT * FROM EXAM7_5_1 X FULL OUTER JOIN EXAM7_5_2 Y
ON X.C=Y.C; -- 6

SELECT * FROM EXAM7_5_1 X RIGHT OUTER JOIN EXAM7_5_2 Y
ON X.C=Y.C; -- 3

-- EXAM7_7
SELECT * FROM EXAM7_7_1;
SELECT * FROM EXAM7_7_2;

SELECT * FROM EXAM7_7_1 A LEFT OUTER JOIN EXAM7_7_2 B
ON (A.C1 = B.C1 AND B.C2 BETWEEN 1 AND 3);


-- EXAM7_10
SELECT * FROM EXAM7_10_1;
SELECT * FROM EXAM7_10_2;

SELECT A, B, C FROM EXAM7_10_1
UNION ALL
SELECT A, B, C FROM EXAM7_10_2;

SELECT A, B, C FROM EXAM7_10_1
UNION 
SELECT A, B, C FROM EXAM7_10_2;

-- 11 
SELECT * FROM EXAM7_11_1;
SELECT * FROM EXAM7_11_2;

SELECT COL1, COL2, COUNT(*) AS CNT 
FROM (SELECT COL1, COL2 
FROM EXAM7_11_1
UNION ALL
SELECT COL1, COL2
FROM EXAM7_11_2
UNION
SELECT COL1, COL2
FROM EXAM7_11_1)
GROUP BY COL1, COL2;

-- EXAM7_13
SELECT * FROM EXAM7_13;

SELECT C3
FROM EXAM7_13
START WITH C2 IS NULL
CONNECT BY PRIOR C1=C2
ORDER SIBLINGS BY C3 DESC;

SELECT C3
FROM EXAM7_13
START WITH C2 IS NULL
CONNECT BY PRIOR C1=C2
ORDER SIBLINGS BY C3;


SELECT C3
FROM EXAM7_13
START WITH C2 IS NULL
CONNECT BY PRIOR C1=C2; 

SELECT C3
FROM EXAM7_13
START WITH C2 IS NULL
CONNECT BY PRIOR C1=C2
ORDER BY C3 DESC;

-- EXAM7_15
SELECT * FROM EXAM7_15;

SELECT 사원번호, 사원명, 입사일자, 매니저사원번호
FROM EXAM7_15
START WITH 매니저사원번호 IS NULL
CONNECT BY PRIOR 사원번호 = 매니저사원번호
AND 입사일자 BETWEEN '2013-01-01' AND '2013-12-31'
ORDER SIBLINGS BY 사원번호;

SELECT 사원번호, 사원명, 입사일자, 매니저사원번호
FROM EXAM7_15
START WITH 매니저사원번호 IS NULL
CONNECT BY PRIOR 사원번호 = 매니저사원번호
AND 입사일자 BETWEEN '2013-01-01' AND '2013-12-31';

SELECT 사원번호, 사원명, 입사일자, 매니저사원번호
FROM EXAM7_15
START WITH 매니저사원번호 IS NULL
CONNECT BY PRIOR 사원번호 = 매니저사원번호
AND 입사일자 BETWEEN '2013-01-01' AND '2013-12-31'
ORDER SIBLINGS BY 사원번호 DESC;

-- EXAM7_17
SELECT * FROM EXAM7_17_1;
SELECT * FROM EXAM7_17_2;

SELECT COUNT(DISTINCT A||B)
FROM EXAM7_17_1
WHERE D=(SELECT D FROM EXAM7_17_2 WHERE E='i'); -- 2

SELECT *
FROM EXAM7_17_1
WHERE D=(SELECT D FROM EXAM7_17_2 WHERE E='i');
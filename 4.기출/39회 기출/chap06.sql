-- EXAM11_11
SELECT * FROM EXAM11_11;

SELECT RANK() OVER(ORDER BY SAL DESC)
AS RANK, NAME, DEPTNAME, POSITION, SAL
FROM EXAM11_11;

SELECT DENSE_RANK() OVER(ORDER BY SAL DESC)
AS DENSE_RANK, NAME, DEPTNAME, POSITION, SAL
FROM EXAM11_11;

SELECT ROW_NUMBER() OVER(ORDER BY SAL DESC)
AS ROW_NUMBER, NAME, DEPTNAME, POSITION, SAL
FROM EXAM11_11;

-- EXAM11_12
SELECT * FROM EXAM11_12;
INSERT INTO EXAM11_12 VALUES(NULL, NULL);

SELECT COALESCE(COL1, COL2*50, 50)
FROM EXAM11_12;

-- EXAM11_14
SELECT * FROM EXAM11_14_1;
SELECT * FROM EXAM11_14_2;
SELECT * FROM EXAM11_14_3;

SELECT * FROM EXAM11_14_1
UNION ALL
SELECT * FROM EXAM11_14_2
MINUS
SELECT * FROM EXAM11_14_3;

SELECT * FROM EXAM11_14_1
UNION ALL
SELECT * FROM EXAM11_14_2;

-- EXAM11_21
SELECT * FROM EXAM11_21;

SELECT ID, PARENT_ID, NAME, PARENT_NAME
FROM EXAM11_21
WHERE PARENT_ID NOT IN(3)
START WITH PARENT_ID = 0
CONNECT BY PRIOR ID = PARENT_ID
ORDER SIBLINGS BY parent_id ASC,
ID ASC;

SELECT ID, PARENT_ID, NAME, PARENT_NAME
FROM EXAM21_1
WHERE PARENT_ID NOT IN(3)
START WITH PARENT_ID = 0
CONNECT BY PRIOR ID = PARENT_ID
ORDER BY parent_id ASC,
ID ASC;

-- EXAM11_23
SELECT * FROM EXAM11_23;

SELECT ID, AGE
FROM EXAM11_23
ORDER BY (CASE WHEN ID = 10 OR ID = 13 THEN 1 ELSE 2 END),
AGE DESC;

-- EXAM11_25
SELECT * FROM EXAM11_25;

SELECT 회원ID, DENSE_RANK() OVER(ORDER BY (주문금액) DESC)
AS RANK, 주문금액
FROM EXAM11_25;

-- EXAM11_26
SELECT * FROM EXAM11_26;

SELECT ID FROM EXAM11_26
GROUP BY ID
HAVING COUNT(*) = 2
ORDER BY (CASE WHEN ID = 1000 THEN
0 ELSE ID END);

-- EXAM11_31
SELECT * FROM EXAM11_31_1;
SELECT * FROM EXAM11_31_2;

SELECT COUNT(DISTINCT COL1)
FROM EXAM11_31_1
WHERE COL3 =
(SELECT COL3 FROM EXAM11_31_2 WHERE
COL2 = 'A');

-- EXAM11_32
SELECT * FROM EXAM11_32;
INSERT INTO EXAM11_32 VALUES(NULL, NULL);

CREATE VIEW V_TEST32
AS SELECT * FROM EXAM11_32
WHERE COL1='A' OR COL1 IS NULL;

SELECT SUM(COL2) 합계
FROM V_TEST32
WHERE COL2 >= 2000;

-- EXAM11_36
SELECT * FROM EXAM11_36;

SELECT * FROM EXAM11_36 WHERE (SUBKPI, MAINKPI)
IN ((20,10),(0,30));

-- 1
SELECT * FROM EXAM11_36 WHERE subkpi = 20;

-- 2
SELECT * FROM EXAM11_36 WHERE subkpi IN (20, 10);

-- 3
SELECT * FROM EXAM11_36 WHERE (subkpi, mainkpi) IN
((10,20),(20,30));

-- 4
SELECT * FROM EXAM11_36 WHERE (subkpi, mainkpi) IN
((20,30),(30,40));

-- EXAM11_40
SELECT * FROM EXAM11_40;

SELECT C2, SUM(C3)
FROM EXAM11_40
GROUP BY C2
HAVING COUNT(*)>=2;

-- EXAM11_49
SELECT * FROM EXAM11_49_1;
SELECT * FROM EXAM11_49_2;

SELECT COUNT(*)
FROM EXAM11_49_1, EXAM11_49_2
WHERE EXAM11_49_1.COL1 = EXAM11_49_2.COL1;